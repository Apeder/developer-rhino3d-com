<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Supporting High DPI Displays</title>
  <meta name="description" content="Supporting High DPI Displays">

  <!-- OpenGraph for Facebook, Twitter, Slack unfurling -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/guides/cpp/supporting_high_dpi_displays/" />
  <meta property="og:title" content="Supporting High DPI Displays" />
  <meta property="og:description" content="This guide discusses the support of high resolution monitors." />
  <meta property=”og:site_name” content="developer.rhino3d.com"/>
  <meta property=”og:image” content="/images/rhinodev_logo_unfurl.png"/>

  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:domain" value="developer.rhino3d.com" />
  <meta name="twitter:title" value="Supporting High DPI Displays" />
  <meta name="twitter:description" value="This guide discusses the support of high resolution monitors." />
  
    
      <meta name="twitter:image" content="/images/rhinodev_logo_unfurl.png" />
    
  
  <meta name="twitter:url" value="http://developer.rhino3d.com" />
  
  <meta name="twitter:label1" value="Platform(s)" />
  <meta name="twitter:data1" value="Windows" />
  
  
  <meta name="twitter:label2" value="Language(s)" />
  <meta name="twitter:data2" value="C/C++" />
  

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/vbnet.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <!-- Overridden theme -->
  <link rel="stylesheet" href="/css/main.css">

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <!-- Bootstrap override -->
  <link rel="stylesheet" href="/css/bootstrap-override.css">

  <link rel="canonical" href="http://developer.rhino3d.com/guides/cpp/supporting_high_dpi_displays/">
  <link rel="alternate" type="application/rss+xml" title="Rhino Developer Docs" href="http://developer.rhino3d.com/feed.xml" />

  <link rel="shortcut icon" href="http://developer.rhino3d.com/favicon.ico?v=2" />
  <!-- Saving bookmarks to mobile devices -->
  <!-- For non-Retina (@1× display) iPhone, iPod Touch, and Android 2.1+ devices: -->
  <link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png"><!-- 57×57px -->
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
  <!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/images/apple-touch-icon-76x76-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
  <!-- For iPhone with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/images/apple-touch-icon-120x120-precomposed.png">
  <!-- For iPad with @2× display running iOS ≤ 6: -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">
  <!-- For iPad with @2× display running iOS ≥ 7: -->
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/images/apple-touch-icon-152x152-precomposed.png">
  <!-- For iPhone 6 Plus with @3× display: -->
  <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/images/apple-touch-icon-180x180-precomposed.png">
  <!-- For Chrome for Android: -->
  <link rel="icon" sizes="192x192" href="images/touch-icon-192x192.png">

</head>


  <body>

    <!-- Google Tag Manager **This belongs right after the <body> tag**-->
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MWMDKN"
        height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-MWMDKN');
    </script>
    <!-- End Google Tag Manager -->


    


    <div class="container">

      <header class="site-header">


    <a class="site-title" href="/"><img src="/images/rhinodevlogo148x128.png" alt="Rhino Developer Docs" height="48" width="56"></a><a class="site-title" href="/">Rhino Developer Docs</a>

    <nav class="site-nav">
      <img class="menu-icon" src="/images/gi.svg">
      
      <div class="trigger">
      	<!--<a class="page-link" href="/">Welcome</a>-->
        <!-- get current page title and "collection" to figure out which nav
             link should be "active" -->
        
        
        
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
            
              
            
          
        
          
        
          
            
              
                
                  <a class="page-link active" href="/guides/">Guides</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/api/">API</a>
                
              
            
          
        
          
            
              
                
                  <a class="page-link" href="/samples/">Samples</a>
                
              
            
          
        
          
            
          
        
        <a class="page-link" href="http://discourse.mcneel.com/c/rhino-developer">Forums</a>
        <!-- Google Search Engine -->
        <!-- TODO Move to this site back into the Mcneel search, or use a simple site only search for results -->
        <div id="sitesearch">
            <!-- Google CSE Search Box Begins  -->
            <!-- Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
            <!-- The terms of service are available at https://www.google.com/cse/docs/tos.html -->
            <form id="cref" action="/search-results.html">
                <input type="hidden" name="cref" value="007988927381198593803:mcq6pshqsn8" />
                <input id="searchtext" type="text" name="q" size="24" value="" placeholder="search" />
                <input class="searchBox" type="submit" name="sa" size="2" value=" " />
            </form>
        <!-- Google CSE Search Box Ends -->
        </div>
        <!--End of Google Search Engine -->
      </div>
    </nav>

</header>


      <div class="page-content">
        <!--div class="wrapper"-->
          <div class="container-fluid">

<div class="row-fluid">
    <!--Nav Bar -->
    <nav class="col-xs-0 col-md-3 bs-docs-sidebar">
        <ul id="sidebar" class="nav nav-stacked fixed">

          <li>
            <a href="/guides/">Guides</a>

            <ul class="nav nav-stacked">

              <li>

                
                  <a href="/guides/#cpp">C/C++</a>
                
                <ul class="nav nav-stacked">

                  <!-- Find the h1 handle for title -->
                  
                  
                  
                  
                  
                  
                  
                  <li>
                    <a href="#supporting-high-dpi-displays">Supporting High DPI Displays</a>

                    <ul class="nav nav-stacked">

                      <!-- Find the h2 group and any h3 subgroups -->
                      

                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#overview">Overview</a>

                          
                            <ul class="nav nav-stacked">
                              

                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#windows-10">Windows 10</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#windows-881">Windows 8/8.1</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#windows-7">Windows 7</a>
                                </li>
                              

                            </ul>
                          

                        </li>
                      
                        
                        
                        
                        
                        
                        <li>
                          <a href="#common-issues">Common Issues</a>

                          
                            <ul class="nav nav-stacked">
                              

                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#general">General</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#icons">Icons</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#cursors">Cursors</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#list-controls-with-image-lists">List Controls with Image ...</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#list-boxes">List Boxes</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#check-list-boxes">Check List Boxes</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#combo-boxes">Combo Boxes</a>
                                </li>
                              
                                
                                
                                
                                
                                
                                <li>
                                    <a href="#check-boxes">Check Boxes</a>
                                </li>
                              

                            </ul>
                          

                        </li>
                      

                    </ul>

                  </li>

                </ul>

              </li>

            </ul>

          </li>

        </ul>
    </nav>
    <!--Main Content -->
    <div class="col-xs-12 col-md-9">
      <!--<div class="post">-->

        <article class="post-content">
          <h1 id="supporting-high-dpi-displays">Supporting High DPI Displays</h1>

<p>This guide discusses the support of high resolution monitors.</p>

<h2 id="overview">Overview</h2>

<p>Super high resolution displays are now common on Windows-based systems, and those using Rhino expect it and 3rd party plug-ins to display correctly on them. Plug-in developers need to make sure their applications are DPI–aware. DPI-aware plug-ins adjust UI elements to scale appropriately to the system DPI. Plug-ins that are not DPI–aware, but are running on a high-DPI display setting, can suffer from many visual artifacts, including incorrect scaling of UI elements, clipped text, and blurry images.</p>

<p>Plug-in developers should run Rhino on high-DPI displays so they can find and fix display issues. Here is how you can configure Windows for high-DPI display:</p>

<h3 id="windows-10">Windows 10</h3>

<ol>
  <li>Right-click on your desktop and click <strong>Display settings</strong>.</li>
  <li>Use the slider to select the text scaling and click <strong>Apply</strong>.</li>
  <li>Logout of Windows and log back in.</li>
</ol>

<h3 id="windows-881">Windows 8/8.1</h3>

<ol>
  <li>Right-click on your desktop and click <strong>Screen resolution</strong>.</li>
  <li>Click the <strong>Make text and other items larger or smaller</strong>.</li>
  <li>Use the slider to select the text scaling and click <strong>Apply</strong>.</li>
  <li>Logout of Windows and log back in.</li>
</ol>

<h3 id="windows-7">Windows 7</h3>

<ol>
  <li>Right-click on your desktop and click *Screen resolution**.</li>
  <li>Click <strong>Make text and other items larger or smaller</strong>.</li>
  <li>Select the text scaling and click <strong>Apply</strong>.</li>
  <li>Logout of Windows and log back in.</li>
</ol>

<h2 id="common-issues">Common Issues</h2>

<p>Most high DPI issues that plug-ins will encounter are due to owner-drawn control. Here, developers have hard-coded sizes or locations, assuming the standard DPI setting. In these cases, custom drawn elements don’t appear correctly, or custom controls don’t work properly.</p>

<p>Other issues have to do with the use of bitmaps or icons that are too small at higher DPI settings or that don’t scale well.</p>

<p>The Rhino SDK has some new tools that developers can use to help make UI elements DPI-aware. See the <code class="highlighter-rouge">CRhinoDpi</code> class declaration in <code class="highlighter-rouge">RhinoSdkDpi.h</code> for more information.</p>

<h3 id="general">General</h3>

<p>The <code class="highlighter-rouge">CRhinoDpi</code> class contains several static function to help with DPI-aware issues.</p>

<p><code class="highlighter-rouge">CRhinoDpi::DpiScale</code> returns the display DPI scale factor when Rhino started. Use this value as a multiplier when owner drawing.</p>

<p><code class="highlighter-rouge">CRhinoDpi::Scale</code> scales a value by the current DPI scale factor.</p>

<h3 id="icons">Icons</h3>

<p>Windows recommends that icon resources contain the following sizes: 16, 32, 48, and 256. All of the icon files (ICO) used by Rhino have been updated to support these sizes.</p>

<p>When loading icons, use <code class="highlighter-rouge">CRhinoDpi::LoadIcon</code>. For example:</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="k">virtual</span> <span class="n">HICON</span> <span class="nf">Icon</span><span class="p">()</span>
<span class="p">{</span> 
  <span class="k">const</span> <span class="kt">int</span> <span class="n">const_icon_size</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">icon_size</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">Scale</span><span class="p">(</span><span class="n">const_icon_size</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">LoadIcon</span><span class="p">(</span><span class="n">AfxGetInstanceHandle</span><span class="p">(),</span> <span class="n">IDI_ICON</span><span class="p">,</span> <span class="n">icon_size</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>and:</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="k">virtual</span> <span class="n">HICON</span> <span class="n">Icon</span><span class="p">(</span><span class="k">const</span> <span class="n">CSize</span><span class="o">&amp;</span> <span class="n">size</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span> 
  <span class="k">return</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">LoadIcon</span><span class="p">(</span><span class="n">AfxGetInstanceHandle</span><span class="p">(),</span> <span class="n">IDI_ICON</span><span class="p">,</span> <span class="n">size</span><span class="p">.</span><span class="n">cx</span><span class="p">,</span> <span class="n">size</span><span class="p">.</span><span class="n">cy</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Note, if the requested icon is not a standard size, the <code class="highlighter-rouge">CRhinoDpi::LoadIcon</code> function scales down a larger image.</p>

<h3 id="cursors">Cursors</h3>

<p>All of the cursors files (CUR) used by Rhino have been updated to support all of the sizes used by Windows 10.</p>

<p>When loading cursor resources, you should so in this manner:</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="n">HCURSOR</span> <span class="n">hCursor</span> <span class="o">=</span> <span class="p">(</span><span class="n">HCURSOR</span><span class="p">)</span><span class="o">::</span><span class="n">LoadImage</span><span class="p">(</span><span class="n">AfxGetInstanceHandle</span><span class="p">(),</span> <span class="n">MAKEINTRESOURCE</span><span class="p">(</span><span class="n">IDC_CURSOR</span><span class="p">),</span> <span class="n">IMAGE_CURSOR</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">LR_DEFAULTSIZE</span> <span class="o">|</span> <span class="n">LR_SHARED</span><span class="p">);</span>
</code></pre>
</div>

<p>By not specifying a size and by using the <code class="highlighter-rouge">LR_DEFAULTSIZE</code> flag, Windows will automatically load the cursor size that is appropriate for the current DPI setting.</p>

<h3 id="list-controls-with-image-lists">List Controls with Image Lists</h3>

<p>The problem with list controls is that the bitmaps, used by their image lists, do not scale very well. The solution is to convert the bitmap strip into individual icon files and then use <code class="highlighter-rouge">CRhinoDpi::CreateImageList</code> to create the image list.</p>

<p>For list controls that use an image list that has a single bitmap, you can do this:</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="n">BOOL</span> <span class="n">CMyDialog</span><span class="o">::</span><span class="n">OnInitDialog</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="c1">// ...
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">IconSize</span><span class="p">(</span><span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">IconType</span><span class="o">::</span><span class="n">SmallIcon</span><span class="p">);</span>
  <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">CreateImageList</span><span class="p">(</span><span class="n">m_image_list</span><span class="p">,</span> <span class="n">AfxGetInstanceHandle</span><span class="p">(),</span> <span class="n">IDI_MYICON</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
  <span class="n">m_list_ctrl</span><span class="p">.</span><span class="n">SetImageList</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_image_list</span><span class="p">,</span> <span class="n">LVSIL_SMALL</span><span class="p">);</span>
  <span class="c1">// ...
</span><span class="p">}</span>
</code></pre>
</div>

<p>For an image list that contains multiple bitmaps, you can do this:</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="n">BOOL</span> <span class="n">CMyDialog</span><span class="o">::</span><span class="n">OnInitDialog</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="c1">// ...
</span>  <span class="k">const</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">IconSize</span><span class="p">(</span><span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">IconType</span><span class="o">::</span><span class="n">SmallIcon</span><span class="p">);</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">image_ids</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">IDI_MYICON0</span><span class="p">,</span> <span class="n">IDI_MYICON1</span><span class="p">,</span> <span class="n">IDI_MYICON2</span><span class="p">,</span> <span class="n">IDI_MYICON3</span> <span class="p">};</span>
  <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">CreateImageList</span><span class="p">(</span><span class="n">m_image_list</span><span class="p">,</span> <span class="n">AfxGetInstanceHandle</span><span class="p">(),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">image_ids</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
  <span class="n">m_list_ctrl</span><span class="p">.</span><span class="n">SetImageList</span><span class="p">(</span><span class="o">&amp;</span><span class="n">m_image_list</span><span class="p">,</span> <span class="n">LVSIL_SMALL</span><span class="p">);</span>
  <span class="c1">// ...
</span><span class="p">}</span>
</code></pre>
</div>

<h3 id="list-boxes">List Boxes</h3>

<p>If you’ve derived your own list boxes, for the sake of owner drawing, then will need to make sure you are setting the item height for each item in the list. Otherwise, items will be scrunched together at higher DPI settings. Use <code class="highlighter-rouge">CRhinoDpi::ListBoxItemHeight</code> to determine this.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="n">CMyListBox</span><span class="o">::</span><span class="n">PreSubclassWindow</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// If the control was created with the LBS_OWNERDRAWFIXED style,
</span>  <span class="c1">// then this will set the item height for all items.
</span>  <span class="k">if</span> <span class="p">(</span><span class="n">GetStyle</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">LBS_OWNERDRAWFIXED</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">itemHeight</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">ListBoxItemHeight</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="n">SetItemHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">itemHeight</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">CListBox</span><span class="o">::</span><span class="n">PreSubclassWindow</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CMyListBox</span><span class="o">::</span><span class="n">MeasureItem</span><span class="p">(</span><span class="n">LPMEASUREITEMSTRUCT</span> <span class="n">lpMeasureItemStruct</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// CListBox::MeasureItem is only called if the control was created
</span>  <span class="c1">// with the LBS_OWNERDRAWVARIABLE style.
</span>  <span class="k">static</span> <span class="kt">int</span> <span class="n">itemHeight</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">ListBoxItemHeight</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">nullptr</span> <span class="o">!=</span> <span class="n">lpMeasureItemStruct</span><span class="p">)</span>
    <span class="n">lpMeasureItemStruct</span><span class="o">-&gt;</span><span class="n">itemHeight</span> <span class="o">=</span> <span class="n">itemHeight</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>There is also a new <code class="highlighter-rouge">CRhinoUiListBox</code> control that you can use in place of <code class="highlighter-rouge">CListBox</code>, that will perform the above calculations for you. See <code class="highlighter-rouge">RhinoSdkUiCheckListbox.h</code> for details.</p>

<h3 id="check-list-boxes">Check List Boxes</h3>

<p>The standard MFC <code class="highlighter-rouge">CCheckListBox</code> class does correctly handle mouse events at high DPI settings. If you are using this class, then modify your code to use <code class="highlighter-rouge">CRhinoUiCheckListBox</code>.  See <code class="highlighter-rouge">RhinoSdkUiCheckListbox.h</code> for details.</p>

<h3 id="combo-boxes">Combo Boxes</h3>

<p>If you’ve derived your own combo boxes, for the sake of owner drawing, then will need to make sure you are setting the item height for each item in the list. Otherwise, items will be scrunched together at higher DPI settings. Use <code class="highlighter-rouge">CRhinoDpi::ComboBoxItemHeight</code> to determine this.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="kt">void</span> <span class="n">CMyComboBox</span><span class="o">::</span><span class="n">PreSubclassWindow</span><span class="p">()</span>
<span class="p">{</span>
  <span class="c1">// If the control was created with the CBS_OWNERDRAWFIXED style,
</span>  <span class="c1">// then this will set the item height for all items.
</span>  <span class="k">if</span> <span class="p">(</span><span class="n">GetStyle</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">CBS_OWNERDRAWFIXED</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">itemHeight</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">ComboBoxItemHeight</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
    <span class="c1">// Set the height of all list items
</span>    <span class="n">SetItemHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">itemHeight</span><span class="p">);</span>
    <span class="c1">// Set the height of the edit-control or static-text portion (Optional)
</span>    <span class="n">SetItemHeight</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">itemHeight</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">CComboBox</span><span class="o">::</span><span class="n">PreSubclassWindow</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">CMyComboBox</span><span class="o">::</span><span class="n">MeasureItem</span><span class="p">(</span><span class="n">LPMEASUREITEMSTRUCT</span> <span class="n">lpMeasureItemStruct</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// CComboBox::MeasureItem is only called if the control was created
</span>  <span class="c1">// with the CBS_OWNERDRAWVARIABLE style.
</span>  <span class="k">static</span> <span class="kt">int</span> <span class="n">itemHeight</span> <span class="o">=</span> <span class="n">CRhinoDpi</span><span class="o">::</span><span class="n">ComboBoxItemHeight</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">nullptr</span> <span class="o">!=</span> <span class="n">lpMeasureItemStruct</span><span class="p">)</span>
    <span class="n">lpMeasureItemStruct</span><span class="o">-&gt;</span><span class="n">itemHeight</span> <span class="o">=</span> <span class="n">itemHeight</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<h3 id="check-boxes">Check Boxes</h3>

<p>If you are owner-drawing check boxes, then there is a good chance their sizes are either hard-coded or they were obtained by calling an incorrect Windows API function. The <code class="highlighter-rouge">CRhinoDpi::CheckBoxSize</code> and <code class="highlighter-rouge">CRhinoDpi::MenuCheckSize</code> static functions will help with this.</p>

        </article>

      <!--</div>-->

    </div>
</div>
</div>

        <!--/div-->
      </div>

      <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">

      
        <div class="row">
          <div class="col-md-4">
            <p class="text">Author: <a href="mailto:dale@mcneel.com">dale@mcneel.com</a></p>
          </div>
          <div class="col-md-4 text-center">
            <span class="icon  icon--github">
              <svg viewBox="0 0 16 16">
                <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <a href="https://github.com/mcneel/developer-rhino3d-com/blob/master/_guide_topics/cpp/supporting_high_dpi_displays.md" target="_blank">Edit page on GitHub</a>
          </div>
            <div class="col-md-4">
              <span class="pull-right">
                <span class="glyphicon glyphicon-cog"></span>&nbsp;<a href="/admin">Admin</a>
              </span>
            </div>
        </div>

        <div class="row text-center">
          © 1997 - 2016 Robert McNeel &amp; Associates
        </div>

      

    </div>

  </div>

  <script>
    if (navigator.appVersion.indexOf("Win")!=-1)
    {
      var body = document.getElementsByTagName("body");
      body[0].style.fontWeight = '400';
    }
  </script>

</footer>

    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>

    <!-- MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <script type="text/javascript">
    $('body').scrollspy({
        target: '.bs-docs-sidebar',
        offset: 150 /* fixed header is about 40px high */
    });
    </script>
  </body>

</html>
